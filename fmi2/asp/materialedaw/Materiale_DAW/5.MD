Dezvoltarea Aplicațiilor Web utilizând ASP.NET Core MVC - Curs 5 

### Cuprins

* **Model (Stratul business - prelucrarea datelor)**: pag. 2 


* **Entity Framework Core**: pag. 3 


* **Instalare Entity Framework Core**: pag. 4 


* **Migrații**: pag. 9 


* **Conexiunea cu Baza de Date**: pag. 13 


* **Dependency Injection**: pag. 13 


* **C.R.U.D. utilizând Entity Framework**: pag. 27 



---

### 1. Ce este Modelul?

Modelul este responsabil pentru **gestionarea și manipularea datelor** din cadrul aplicației. Acesta reprezintă nucleul aplicației, realizând legătura directă cu baza de date și procesând cererile venite de la View prin intermediul Controller-ului. Accesul la date se face prin atributele publice ale claselor.

### 2. Entity Framework Core (EF Core)

Entity Framework este un **ORM (Object Relational Mapper)** open source pentru .NET.

* 
**Scop**: Permite dezvoltatorilor să se concentreze pe aplicație, nu pe baza de date, corelând clasele din model cu tabelele din baza de date.


* 
**EF Core**: Este o versiune "light" și cross-platform (Windows, Linux) care suportă atât tehnici **database-first**, cât și **code-first**.


* 
**LINQ (Language Integrated Query)**: Permite scrierea de interogări direct în C# pentru diverse surse de date (SQL Server, Oracle, XML, etc.).



### 3. Instalarea EF Core

Instalarea se face prin **NuGet Package Manager** urmând pașii:

1. 
**Tools** → **NuGet Package Manager** → **Manage NuGet Packages for Solution**.


2. Căutarea și instalarea pachetului `Microsoft.EntityFrameworkCore`.


3. Acceptarea termenilor de licență.


4. Verificarea instalării în consolă sau în secțiunea **Dependencies** a proiectului.



> 
> **Notă:** Sunt necesare și pachetele `Microsoft.EntityFrameworkCore.SqlServer`, `.Design` și `.Tools` pentru gestionarea bazei de date și a migrațiilor.
> 
> 

---

### 4. Conexiunea cu Baza de Date și Dependency Injection

#### Dependency Injection (DI)

DI este un design pattern care **abstractizează implementarea**, injectând automat dependențele (servicii, obiecte) într-o componentă (ex: Controller) în loc ca aceasta să le creeze manual.

#### Metode de conectare:

| Varianta 1 (Fără DI) | Varianta 2 (Cu DI) |
| --- | --- |
| Necesită instanțierea manuală a contextului în fiecare Controller: `private AppDbContext db = new AppDbContext();`.

 | Contextul este injectat prin constructor: `public ArticlesController (AppDbContext context) { db = context; [cite_start]}`.

 |
| Stringul de conexiune este adesea hardcodat în metoda `OnConfiguring`.

 | Stringul de conexiune este stocat în `appsettings.json` și configurat în `Program.cs`.

 |

---

### 5. Migrații

Migrațiile sunt necesare pentru a **sincroniza modificările din cod** (clase noi, proprietăți noi) cu baza de date.

* 
**Add-Migration [Nume]**: Compară modelul curent cu cel anterior și generează codul necesar.


* 
**Update-Database**: Aplică modificările în baza de date.



---

### 6. Operații C.R.U.D.

Implementarea operațiilor folosind clasa de context (ex: `AppDbContext db`):

* 
**Index (Read all)**: Preluarea studenților ordonați: `from student in db.Students orderby student.Name select student`.


* 
**Show (Read one)**: Găsirea după ID: `db.Students.Find(id)`.


* 
**New (Create)**: Adăugarea unui obiect nou: `db.Students.Add(s); db.SaveChanges();`.


* 
**Edit (Update)**: Modificarea atributelor unui obiect existent urmată de `db.SaveChanges()`.


* 
**Delete (Delete)**: Ștergerea unui obiect: `db.Students.Remove(student); db.SaveChanges();`.



> 
> **Model Binding**: Procesul automat prin care datele trimise prin HTTP POST/GET sunt mapate pe atributele modelului, condiția fiind ca numele câmpurilor din View să coincidă cu cele din Model.
> 
> 

## Dezvoltarea Aplicațiilor Web utilizând ASP.NET Core MVC - Laborator 5

### Obiective

* Crearea modelului de date în cadrul stratului business (Model).


* Configurarea Entity Framework Core și conectarea la baza de date SQL Server.


* Utilizarea Dependency Injection pentru gestionarea serviciilor.


* Crearea și aplicarea migrațiilor pentru generarea bazei de date.



---

### Scenariu

Se va realiza o aplicație ASP.NET Core MVC pentru gestionarea de **articole** și **categorii**. Relația dintre acestea este de tipul: o categorie conține mai multe articole, iar fiecare articol aparține unei singure categorii. Baza de date va fi construită de la zero folosind tehnica code-first.

---

### Exerciții

#### Exercițiul 1 - Crearea proiectului și configurarea EF Core

1. Creați un proiect numit **Laborator5** de tip **ASP.NET Core Web App (Model-View-Controller)**.


2. Adăugați pachetele NuGet necesare pentru Entity Framework Core și SQL Server.



#### Exercițiul 2 - Crearea modelelor

Adăugați modelele `Article` și `Category` cu următoarele proprietăți:

| Entitate | Proprietăți |
| --- | --- |
| **Article** | <br>`Id` (int, PK), `Title` (string), `Content` (string), `Date` (DateTime) 

 |
| **Category** | <br>`Id` (int, PK), `CategoryName` (string) 

 |

**Exemplu implementare Article:**

```csharp
public class Article
{
    [Key]
    public int Id { get; set; }
    public string Title { get; set; }
    public string Content { get; set; }
    public DateTime Date { get; set; }
}

```



#### Exercițiul 3 - Configurare DbContext și Dependency Injection

4. Realizați conexiunea cu baza de date utilizând **Dependency Injection**.


5. Adăugați baza de date SQL Server cu Connection String-ul numit **ArticlesDB**.



#### Exercițiul 4 - Migrații

6. Integrați sistemul de migrații pentru a genera structura bazei de date.



#### Exercițiul 5 - Implementare C.R.U.D.

Creați controllerele `ArticlesController` și `CategoriesController` pentru a implementa următoarele operații:

* 
**Index**: Afișarea tuturor înregistrărilor.


* 
**Show**: Afișarea unei singure entități.


* 
**New**: Adăugarea unei noi înregistrări.


* 
**Edit**: Editarea unei înregistrări existente.


* 
**Delete**: Ștergerea unei înregistrări.



---

### Utilizarea Inteligenței Artificiale (Exercițiile 6-8)

Laboratorul propune utilizarea unui companion AI pentru:

* 
**Validarea modelului**: Verificarea convențiilor de denumire și a relațiilor între entități.


* 
**Analiza normalizării**: Verificarea structurii bazei de date conform formelor normale (1NF, 2NF, 3NF).


* 
**Documentare automată**: Generarea unei documentații Markdown pentru clasele create.
